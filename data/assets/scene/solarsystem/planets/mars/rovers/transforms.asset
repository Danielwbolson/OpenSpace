local assetHelper = asset.require('util/asset_helper')
local kernels = asset.require('./kernels')
local marsTransforms = asset.require('scene/solarsystem/planets/mars/transforms')
--local sunTransforms = asset.require('scene/solarsystem/sun/transforms')

local correctRotation = {
    Identifier = "correctRotation",
    Parent = "MarsBarycenter",
    Transform = {
        Rotation = {
          Type = "SpiceRotation",
          SourceFrame = "IAU_MARS",  
          DestinationFrame = "J2000"
        }
    }
}


--translate out to mars surface
local centerMars = {
    Identifier = "centerMars",
    Parent = correctRotation.Identifier,
    Transform = {
        Translation = {
            Type = "SpiceTranslation",
            Target = "MSL",                 
            Observer = "MARS",
            Frame = "J2000",                        
            Kernels = kernels.CuriosityKernels          
        }
    }
}


local landingSite = {
    Identifier = "landingSite",
    Parent =  centerMars.Identifier,
    Transform = {
        Translation = {
            Type = "SpiceTranslation",
            Target = "MSL",
            Observer = "MSL_LANDING_SITE",
            Frame = "MSL_TOPO",                     
            Kernels = kernels.CuriosityKernels          
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local MSL_Location = {
    Identifier = "MSL_Location",
    Parent =  landingSite.Identifier,
    --Transform = {
    --    Scale = {
    --         Type = "StaticScale",
    --         Scale = 10.0
    --    }
    --},
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}



---- ROBOTIC ARM RA ----

local RA_Base_Location = {
    Identifier = "RA_Base_Location",
    Parent = MSL_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = { 1.111, -0.4525, -0.106 }
        },
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_ROVER",
            DestinationFrame = "MSL_RA_BASE"
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

--AZ
local RA_Shoulder_AZ_Location = {
    Identifier = "RA_Shoulder_AZ_Location",
    Parent = RA_Base_Location.Identifier,
    Transform = {   
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RA_BASE",
            DestinationFrame = "MSL_RA_SHOULDER_AZ",
            Kernels = kernels.CuriosityKernels
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

----EL
local RA_Shoulder_EL_Location = {
    Identifier = "RA_Shoulder_EL_Location",
    Parent = RA_Shoulder_AZ_Location.Identifier,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RA_SHOULDER_AZ",
            DestinationFrame = "MSL_RA_SHOULDER_EL",
            Kernels = kernels.CuriosityKernels
        },
        Translation = {
            Type = "StaticTranslation",
            Position = {0.15, 0.2, 0.0}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

--ELBOW
local RA_Elbow_Location = {
    Identifier = "RA_Elbow_Location",
    Parent = RA_Shoulder_EL_Location.Identifier,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RA_SHOULDER_EL",
            DestinationFrame = "MSL_RA_ELBOW",
            Kernels = kernels.CuriosityKernels
        },
        Translation = {
            Type = "StaticTranslation",
            Position = {0.83, -0.2, 0.0 }
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

--WRIST
local RA_Wrist_Location = {
    Identifier = "RA_Wrist_Location",
    Parent = RA_Elbow_Location.Identifier,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RA_ELBOW",
            DestinationFrame = "MSL_RA_WRIST",
            Kernels = kernels.CuriosityKernels
        },
        Translation = {
            Type = "StaticTranslation",
            Position = {0.77, 0.13, 0.035}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}


--TURRET
local RA_Turret_Location = {
    Identifier = "RA_Turret_Location",
    Parent = RA_Wrist_Location.Identifier,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RA_TURRET",
            DestinationFrame = "MSL_MAHLI_REF",
            Kernels = kernels.CuriosityKernels
        },
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.04, -0.15}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

--MAHLI
local RA_Mahli_Location = {
    Identifier = "RA_Mahli_Location",
    Parent = RA_Turret_Location.Identifier
}


---- MASTCAM RSM ----
local RSM_ZERO_AZ_Location = {
    Identifier = "RSM_ZERO_AZ_Location",
    Parent = MSL_Location.Identifier,
    Transform = {
        Translation = {
            Type = "StaticTranslation",
            Position = {0.702, 0.575, -0.526}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local RSM_AZ_Location = {
    Identifier = "RSM_AZ_Location",
    Parent = RSM_ZERO_AZ_Location.Identifier,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RSM_ZERO_AZ",
            DestinationFrame = "MSL_RSM_AZ",
            Kernels = kernels.CuriosityKernels
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local RSM_ZERO_EL_Location = {
    Identifier = "RSM_ZERO_EL_Location",
    Parent = RSM_AZ_Location.Identifier,
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local RSM_EL_Location = {
    Identifier = "RSM_EL_Location",
    Parent = RSM_ZERO_EL_Location.Identifier,
    Transform = {
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, -0.664}
        },
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_RSM_ZERO_EL",
            DestinationFrame = "MSL_RSM_EL",
            Kernels = kernels.CuriosityKernels
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}



---- HIGH GAIN ANTENNA HGA ----

local HGA_AZ_Location = {
    Identifier = "HGA_AZ_Location",
    Parent = MSL_Location.Identifier,
    Transform = {   
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_ROVER",
            DestinationFrame = "MSL_HGA_AZ",
            Kernels = kernels.CuriosityKernels
        },
        Translation = {
            Type = "StaticTranslation",
            Position = {-0.46, -0.47, -0.55}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local HGA_EL_Location = {
    Identifier = "HGA_EL_Location",
    Parent = HGA_AZ_Location.Identifier,
    Transform = {   
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "MSL_HGA_AZ",
            DestinationFrame = "MSL_HGA_EL",
            Kernels = kernels.CuriosityKernels
        },
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, -0.17}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

---- SAM & HEMIN ----

local SAM_Cover_1_Location = {
    Identifier = "SAM_Cover_1_Location",
    Parent = MSL_Location.Identifier,
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local SAM_Cover_2_Location = {
    Identifier = "SAM_Cover_2_Location",
    Parent = MSL_Location.Identifier,
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local CHEMIN_Location = {
    Identifier = "CHEMIN_Location",
    Parent = MSL_Location.Identifier,
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}


---- Wheels ----

local Wheel_base_Location = {
    Identifier = "Wheel_base_Location",
    Parent = MSL_Location.Identifier,
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

-- Left side --
local Leg_1A_L_Location = {
    Identifier = "Leg_1A_L_Location",
    Parent = Wheel_base_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.185, -0.75, -0.22}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Leg_1B_L_Location = {
    Identifier = "Leg_1B_L_Location",
    Parent = Leg_1A_L_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, 0.0}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

-- Right now, same as Wheel_Leg_2_R
local Leg_2_L_Location = {
    Identifier = "Leg_2_L_Location",
    Parent = Leg_1B_L_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {-0.74, 0.0, 0.24}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wrist_F_L = {
    Identifier = "Wrist_F_L",
    Parent = Leg_1A_L_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.882, -0.26, 0.2}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wheel_F_L_Location = {
    Identifier = "Wheel_F_L_Location",
    Parent = Wrist_F_L.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, 0.45}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wheel_C_L_Location = {
    Identifier = "Wheel_C_L_Location",
    Parent = Leg_2_L_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.45, -0.4, 0.4}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}


local Wrist_B_L_Location = {
    Identifier = "Wrist_B_L_Location",
    Parent = Leg_2_L_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {-0.62, -0.27, 0.0}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}


local Wheel_B_L_Location = {
    Identifier = "Wheel_B_L_Location",
    Parent = Wrist_B_L_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, -0.0, 0.42}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}




-- Right Side --

local Leg_1A_R_Location = {
    Identifier = "Leg_1A_R_Location",
    Parent = Wheel_base_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.185, 0.75, -0.22}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Leg_1B_R_Location = {
    Identifier = "Leg_1B_R_Location",
    Parent = Leg_1A_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, 0.0}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Leg_2_R_Location = {
    Identifier = "Leg_2_R_Location",
    Parent = Leg_1A_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {-0.74, 0.0, 0.24}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wrist_F_R_Location = {
    Identifier = "Wrist_F_R_Location",
    Parent = Leg_1A_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.882, 0.26, 0.2}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}


local Wheel_F_R_Location = {
    Identifier = "Wheel_F_R_Location",
    Parent = Wrist_F_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, 0.45}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wheel_C_R_Location = {
    Identifier = "Wheel_C_R_Location",
    Parent = Leg_2_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.45, 0.4, 0.4}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wrist_B_R_Location = {
    Identifier = "Wrist_B_R_Location",
    Parent = Leg_2_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {-0.62, 0.27, 0.0}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

local Wheel_B_R_Location = {
    Identifier = "Wheel_B_R_Location",
    Parent = Wrist_B_R_Location.Identifier,
    Transform = {   
        Translation = {
            Type = "StaticTranslation",
            Position = {0.0, 0.0, 0.42}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Mars/Curiosity/Model"
    }
}

assetHelper.registerSceneGraphNodesAndExport(asset, { 
    correctRotation,
    centerMars,
    landingSite,
    MSL_Location,
    RA_Base_Location,
    RA_Shoulder_AZ_Location,
    RA_Shoulder_EL_Location,
    RA_Elbow_Location,
    RA_Wrist_Location,
    RA_Turret_Location,
    RA_Mahli_Location,
    RSM_ZERO_AZ_Location,
    RSM_AZ_Location,
    RSM_ZERO_EL_Location,
    RSM_EL_Location,

    HGA_AZ_Location,
    HGA_EL_Location,
    SAM_Cover_1_Location,
    SAM_Cover_2_Location,
    CHEMIN_Location,

    Wheel_base_Location,
    Leg_1A_L_Location,
    Leg_1B_L_Location,
    Leg_2_L_Location,
    Wrist_F_L,
    Wheel_F_L_Location,
    Wheel_C_L_Location,
    Wrist_B_L_Location,
    Wheel_B_L_Location,

    Leg_1A_R_Location,
    Leg_1B_R_Location,
    Leg_2_R_Location,
    Wrist_F_R_Location,
    Wheel_F_R_Location,
    Wheel_C_R_Location,
    Wrist_B_R_Location,
    Wheel_B_R_Location

})

